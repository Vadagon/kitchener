(()=>{"use strict";document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("authenticateBtn"),t=document.getElementById("settingsBtn"),r=document.querySelector(".settingpage"),o=document.querySelector(".mainpage");t.addEventListener("click",(()=>{n()}));var n=()=>{r.classList.toggle("active"),o.classList.toggle("active")};function s(e){const t=document.querySelector(".records");if(t.innerHTML="",console.log("records",e),0===e.length){const e=document.createElement("div");e.className="no-records",e.innerText="There are no updated orders yet",e.style.textAlign="center",t.appendChild(e)}else e.sort(((e,t)=>new Date(t.dateAdded)-new Date(e.dateAdded))).forEach((e=>{const r=document.createElement("div");r.className="record";const o=new Date(e.dateAdded),n=new Date-o;let s;s=n<6e4?`${Math.floor(n/1e3)} seconds ago`:n<36e5?`${Math.floor(n/6e4)} minutes ago`:n<864e5?`${Math.floor(n/36e5)} hours ago`:o.toLocaleString();const c=Array.isArray(e.Booking_ID)&&e.Booking_ID.length>0?e.Booking_ID[0]:e.Booking_ID["Order ID"],a=e["Order Description"]??e["Special Requests"];r.innerHTML=`\n        <p class="record-title">${c}</p>\n        <p class="record-description">${a}</p>\n        <p class="record-date">${s}</p>\n      `,t.appendChild(r)}))}e.addEventListener("click",(()=>{chrome.runtime.sendMessage({action:"authenticate"},(e=>{e.error?console.error("Authentication Error:",e.error):console.log("Authenticated successfully")}))})),chrome.runtime.sendMessage({action:"getBasesList"},(e=>{if(e.error)console.error("Error fetching bases list:",e.error);else{!function(e){console.log(12321);const t=document.querySelector(".squares");e.forEach((e=>{const r=document.createElement("div");r.className="square",r.innerHTML=`\n      <input type="checkbox" id="selectBox-${e.id}" class="select-box">\n      <label for="selectBox-${e.id}" class="base-name">${e.name}</label>\n    `,t.appendChild(r)})),e.length&&n()}(e.bases);const t=document.querySelectorAll(".select-box");t.length>0&&(t[0].checked=!0)}})),chrome.storage.local.get("error",(e=>{e.error&&(console.error("Last Error:",e.error),document.getElementById("error").innerText=e.error,chrome.storage.local.remove("error"))})),chrome.storage.local.get("lastCapturedRecords",(e=>{if(console.log("result",e),e.lastCapturedRecords){const t=new Date,r=e.lastCapturedRecords.filter((e=>{console.log("sdsds",e.dateAdded);const r=new Date(e.dateAdded);return t-r<864e5}));s(r),chrome.storage.local.set({lastCapturedRecords:r})}else s([])}))}))})();